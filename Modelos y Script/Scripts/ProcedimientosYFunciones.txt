/*PROCEDURES*/
create or replace procedure add_user (dni usuario.dni_usuario%type, nombre usuario.nombre_usuario%type, 
    telefono usuario.telefono_usuario%type, correo usuario.correo_usuario%type, dir usuario.direccion_usuario%type,
    alergias usuario.alergias_usuario%type, f_nac usuario.fecha_nacimiento_usuario%type)
is
begin
	insert into usuario values (dni, nombre, telefono, correo, dir, alergias, f_nac);
end add_user;


create or replace procedure translate_dates
is
 cursor dates is select numero_acceso, fecha_acceso from acceso;
 mes char(15); 	--el mes a traducir 
begin
	for d in dates
	loop 
		mes := upper(to_char(d.fecha_acceso, 'Month'));
		dbms_output.put_line('ACCESO. numero_acceso: ' || d.numero_acceso || 'mes acceso(original): ' || mes);
		case mes
		when 'JANUARY' then
			mes := 'ENERO';
		when 'FEBRUARY' then
			mes := 'FEBRERO';
		when 'MARCH' then
			mes := 'MARZO';
		when 'APRIL' then
			mes := 'ABRIL';
		when 'MAY' then
			mes := 'MAYO';
		when 'JUNE' then
			mes := 'JUNIO';
		when 'JULY' then
			mes := 'JULIO';
		when 'AUGUST' then
			mes := 'AGOSTO';
		when 'SEPTEMBER' then
			mes := 'SEPTIEMBRE';
		when 'OCTOBER' then
			mes := 'OCTUBRE';
		when 'NOVEMBER' then
			mes := 'NOVIEMBRE';
		when 'DECEMBER' then
			mes := 'DICIEMBRE';
		else
            mes := 'error';
		end case;
		dbms_output.put_line('ACCESO. id_acceso: ' || d.numero_acceso || ' - fecha_acceso(traducida): ' || mes);
	end loop;
end translate_dates;

create or replace function num_asistentes_fecha(fecha date) return integer
is
	v_num_acceso integer := 0;
	v_num_evento integer := 0;
	v_num_total	integer;
begin
	select count(*) into v_num_acceso from acceso where fecha_acceso=fecha;
	select count(*) into v_num_evento from evento where fecha_evento=fecha;
	v_num_total := v_num_acceso + v_num_evento;
	return v_num_total;
end num_asistentes_fecha;

begin 
	dbms_output.put_line('Gente que acude en el d√≠a 07-05-2022: ' || num_asistentes_fecha(to_date('07-05-2022','dd-mm-yyyy')));
end;

create or replace function 




